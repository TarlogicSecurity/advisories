# CVE-2025-27840

[![](https://img.shields.io/badge/CVSS%20v3.1%20Score-6.8%20%2F%20Medium-yellow)](https://nvd.nist.gov/vuln-metrics/cvss/v3-calculator?vector=AV:P/AC:H/PR:H/UI:N/S:C/C:H/I:H/A:L&version=3.1)

Espressif ESP32 chips contain 29 undocumented HCI commands.

**Vendor:** Espressif<br>
**Products:** ESP32<br>
**Discovered by:** Antonio VÃ¡zquez Blanco ([@antonvblanco](https://x.com/antonvblanco))<br>
**Public fix:** Unknown/Awaiting<br>
**Proof of Concept:** https://github.com/TarlogicSecurity/BluetoothExamplesAndDemos/tree/main/VendorCommandEnumerator<br>
**References**: https://www.tarlogic.com/blog/esp32-hidden-hci-vendor-commands/<br>

## Summary

Espressif ESP32 chips contain 29 undocumented HCI commands.

## Details

The following command opcodes have been reverse engineered from ESP32 ROM files.

| Opcode | Command                             |
| ------ | ----------------------------------- |
| OxFC01 | Read memory                         |
| OxFC02 | Write memory                        |
| OxFC03 | Delete NVDS parameter               |
| OxFC05 | Get flash ID                        |
| OxFC06 | Erase flash                         |
| OxFC07 | Write flash                         |
| OxFC08 | Read flash                          |
| OxFC09 | Read NVDS parameter                 |
| OxFC0A | Write NVDS parameter                |
| OxFC0B | Enable/disable coexistence          |
| OxFC0E | Send LMP packet                     |
| OxFC10 | Read kernel stats                   |
| OxFC11 | Platform reset                      |
| OxFC12 | Read memory info                    |
| OxFC30 | Register read                       |
| OxFC31 | Register write                      |
| OxFC32 | Set MAC address                     |
| OxFC35 | Set CRC initial value               |
| OxFC36 | LLCP msgs discard                   |
| OxFC37 | Reset RX count                      |
| OxFC38 | Reset TX count                      |
| OxFC39 | RF register read (Not implemented)  |
| OxFC3A | RF register write (Not implemented) |
| OxFC3B | Set TX password                     |
| OxFC40 | Set LE parameters                   |
| OxFC41 | Write LE default values             |
| OxFC42 | LLCP pass through enable            |
| OxFC43 | Send LLCP packet                    |
| OxFC44 | LMP msgs discard                    |

More technical details can be found at <https://www.tarlogic.com/blog/esp32-hidden-hci-vendor-commands/>.

## Impact

The hidden opcodes allow for command execution and firmware protection mechanisms bypass if access to the HCI interface is gained.

This only poses a security issue when the ESP32 chip is used for communication with external devices, exposing the HCI interface via hardware to other chips.

Exploitation may only take place via physical access or by previously compromising a chip with access to ESP32 HCI interface.

## Recommendation

Espressif in their <https://developer.espressif.com/blog/2025/03/esp32-bluetooth-clearing-the-air/> blog post mention a future HCI command removal.

## Timeline

- 2025/03/06 - A talk is given at RootedCON where the commands are shown as a tool.
- 2025/03/08 - MITRE publishes the CVE listing the discovery.
- 2025/05/21 - Advisory is published.
